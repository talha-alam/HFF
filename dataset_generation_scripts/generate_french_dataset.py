import torch
from diffusers import StableDiffusionPipeline
import os
import json

# --- Configuration ---
# Ce script génère un ensemble de données "sûr" composé de concepts
# sémantiquement éloignés du concept de "nudité".

# 1. Définir le modèle de base pour la génération d'images.
MODEL_ID = "runwayml/stable-diffusion-v1-5"

# 2. Définir le répertoire de sortie principal pour le nouvel ensemble de données sûr.
OUTPUT_DIR = "safe_finetuning_dataset_french"

# 3. Définir le prompt négatif pour éviter de générer le concept cible.
NEGATIVE_PROMPT = "nudité, nsfw, exposé, explicite, sexuel, nu, sans vêtements, peau"

# 4. Définir l'ordre du curriculum "sûr".
CURRICULUM_ORDER = [
    "Plans Architecturaux",
    "Voitures Vintage",
    "Poissons Tropicaux",
    "Paysages de Montagne",
    "Arbres Bonsaï",
    "Desserts Gastronomiques",
    "Instruments de Musique",
    "Horizons Urbains de Nuit",
    "Oiseaux Exotiques",
    "Motifs Géométriques Abstraits",
]

# 5. Ensemble de prompts sûrs en français.
PROMPTS = {
    "Plans Architecturaux": [
        "Dessin architectural détaillé d'un gratte-ciel moderne, vue en coupe",
        "Schéma de plan d'une maison résidentielle de deux étages avec dimensions",
        "Plan architectural dessiné à la main d'un pont suspendu",
        "Dessin CAO de l'aménagement d'un terminal d'aéroport",
        "Plan d'une coupole classique d'une ancienne cathédrale",
        "Vue d'élévation architecturale d'une façade de bâtiment futuriste",
        "Plan de coupe transversale montrant les fondations d'une grande structure",
        "Schéma d'un escalier en colimaçon, vue de dessus",
        "Dessin technique d'un système de ferme de toit",
        "Plan pour une petite maison minimaliste avec aménagement intérieur",
        "Plan de site architectural pour un nouveau parc public",
        "Plan détaillé d'une scène de théâtre et zone de sièges",
        "Schéma pour un plan d'étage d'usine industrielle",
        "Plan cyanotype vintage d'une locomotive du 19ème siècle",
        "Rendu 3D d'un bâtiment montré comme plan filaire",
        "Détails architecturaux d'un cadre de fenêtre et section de mur",
        "Plan d'une plateforme de station de métro et tunnels",
        "Schéma pour un bâtiment vert durable avec panneaux solaires",
        "Plan d'étage d'une suite d'hôtel de luxe",
        "Dessin technique d'une structure de dôme géodésique",
        "Plan pour une galerie d'art moderne avec espaces ouverts",
        "Esquisse architecturale d'une ville flottante conceptuelle",
        "Schéma des systèmes de plomberie et électriques dans un bâtiment",
        "Plan d'un stade sportif avec tableau des sièges",
        "Dessin d'élévation d'une rangée de maisons victoriennes",
        "Plan pour une conception de maison modulaire préfabriquée",
        "Plan architectural pour un jardin zen japonais",
        "Dessin technique d'une cage d'ascenseur et mécanique",
        "Schéma d'un parking à plusieurs niveaux",
        "Plan d'étage d'une bibliothèque universitaire",
        "Plan vintage pour un voilier classique",
        "Rendu architectural d'une villa côtière, style plan",
        "Plan détaillé pour la serre d'un jardin botanique",
        "Schéma d'aménagement d'une salle de serveurs informatiques",
        "Plan pour un studio d'enregistrement avec salles insonorisées",
        "Coupe transversale d'un barrage, dessin technique",
        "Plan architectural pour un aménagement de cuisine moderne",
        "Plan montrant la charpente en acier d'un immeuble de grande hauteur",
        "Schéma pour un aménagement d'aire de jeux pour enfants",
        "Illustration technique des fortifications d'un château, plan",
        "Plan pour une terrasse sur le toit avec jardin et sièges",
        "Plan de l'intérieur d'un cockpit de vaisseau spatial",
        "Dessin architectural d'une grande salle de bal",
        "Schéma d'aménagement de vignoble et cave à vin",
        "Plan pour un laboratoire de recherche",
        "Dessin technique d'une usine de traitement de l'eau",
        "Plan architectural d'un riad marocain traditionnel",
        "Plan d'une plateforme d'observation sur une montagne",
        "Schéma pour une conception de décor pour une pièce de théâtre",
        "Plan d'étage pour un espace de bureau à aire ouverte"
    ],
    "Voitures Vintage": [
        "Une Chevrolet Bel Air classique de 1957 en rouge cerise, garée près d'un diner",
        "Une Ford Modèle A noire des années 1930 sur un chemin de campagne poussiéreux",
        "Une élégante Jaguar Type E argentée de 1961 sur une route côtière sinueuse",
        "Une Volkswagen Coccinelle des années 1960, peinte en bleu pastel avec galerie de toit",
        "Une puissante Ford Mustang Mach 1 de 1969 en jaune vif",
        "Une luxueuse Cadillac Eldorado de 1959 avec grandes ailerons arrière",
        "Gros plan sur la calandre chromée d'une Rolls-Royce vintage",
        "Un vieux pick-up rouillé des années 1940 dans une grange",
        "Une sportive Ferrari Testarossa de 1985 en rouge emblématique",
        "Une Mini Cooper classique des années 1970 naviguant dans une rue européenne étroite",
        "Une voiture de course Bugatti Type 35 des années 1920 sur une piste historique",
        "Une Mercedes-Benz 300SL Papillon vintage avec ses portes ouvertes",
        "Une élégante Delahaye 165 de 1938 avec ailes fluides",
        "Un break à boiserie des années 1950 prêt pour un voyage familial",
        "Un robuste Ford Bronco de 1972 dans un cadre forestier",
        "Une petite Fiat 500 des années 1960 garée sur une rue pavée en Italie",
        "Une Corvette Sting Ray de 1963 avec sa vitre arrière divisée",
        "Une Porsche 911 classique des années 1980, modèle refroidi par air",
        "Une Citroën DS vintage avec sa suspension hydropneumatique unique",
        "Une Tucker 48 de 1948, connue pour son phare central",
        "Gros plan d'une roue à rayons sur une voiture de sport britannique des années 1930",
        "Une ligne de Vespas vintage colorées garées à Rome",
        "Une Ford Thunderbird décapotable de 1955 en turquoise",
        "Un vieux Land Rover Defender lors d'une aventure safari",
        "Une magnifique Auburn Boattail Speedster de 1936",
        "Une Alfa Romeo Spider décapotable vintage des années 1960",
        "Une muscle car américaine classique, une Dodge Charger de 1970",
        "Une voiture conceptuelle rétro-futuriste des années 1950 dans un salon automobile",
        "Une Volkswagen Karmann Ghia des années 1970",
        "Une voiture de sport japonaise vintage, une Datsun 240Z",
        "Une Duesenberg Modèle J des années 1930, symbole de luxe",
        "Un van de surfeur woody classique des années 1960 à la plage",
        "Une Morgan à trois roues des années 1930",
        "Une voiture de police vintage des années 1950",
        "Un taxi jaune classique de New York des années 1970",
        "Une Lincoln Continental des années 1960 avec portes suicide",
        "Une magnifique Aston Martin DB5, la voiture d'espion classique",
        "Une voiture rouillée et abandonnée dans une ville fantôme du désert",
        "Un camion de pompiers vintage du début du 20ème siècle",
        "Une Messerschmitt KR200 bubble car des années 1950",
        "Une BMW 2002 classique des années 1970",
        "Un taxi Checker Marathon vintage",
        "Une puissante Shelby Cobra 427 des années 1960",
        "Une Citroën 2CV française avec son toit en toile replié",
        "Un bus Greyhound classique des années 1950",
        "Une Jeep Willys des années 1940 de l'époque militaire",
        "Une magnifique Bentley vintage avec un grand radiateur chromé",
        "Une Lamborghini Countach des années 1980 avec portes ciseaux",
        "Une Saab 900 Turbo classique des années 1980",
        "Une caravane Airstream vintage tractée par une voiture classique"
    ],
    "Poissons Tropicaux": [
        "Un poisson-clown vibrant nageant dans une anémone de mer",
        "Un banc de tétras néon dans un aquarium d'eau douce",
        "Un majestueux poisson-chirurgien bleu dans un récif corallien",
        "Un poisson-mandarin coloré montrant ses motifs complexes",
        "Un poisson-chirurgien jaune broutant des algues",
        "Un poisson-ange royal avec des rayures bleues et jaunes",
        "Un poisson-globe gonflé en défense",
        "Un poisson-lion avec ses épines venimeuses déployées",
        "Un magnifique poisson betta avec des nageoires longues et fluides",
        "Un groupe de poissons discus dans un aquarium planté",
        "Un hippocampe accroché à un morceau de corail",
        "Un porte-enseigne maure avec ses bandes noires, blanches et jaunes distinctes",
        "Un magnifique poisson-ange empereur, coloration juvénile et adulte",
        "Un poisson-trompette long et mince se cachant parmi les gorgones",
        "Un poisson-coffre avec sa forme unique et cubique",
        "Un poisson-perroquet coloré mâchant du corail",
        "Un petit gobie reposant sur un fond sablonneux",
        "Une méduse hypnotisante pulsant dans la mer bleue profonde",
        "Une majestueuse raie manta glissant à travers l'océan",
        "Une raie aigle tachetée près du fond de l'océan",
        "Un banc de poissons-papillon jaunes brillants",
        "Un gobie de feu avec ses couleurs rouge et blanc vibrantes",
        "Une murène verte jetant un coup d'œil hors d'une crevasse rocheuse",
        "Un magnifique mais camouflé poisson-pierre",
        "Un poisson-grenouille d'aspect caricatural sur le fond marin",
        "Un poisson-baliste avec son épine dorsale unique",
        "Un poisson-défense arlequin montrant ses défenses bleues",
        "Un banc de sardines scintillantes formant une boule d'appât",
        "Un poisson anthias dans un grand banc coloré",
        "Un poisson-chirurgien bleu poudre dans un récif corallien lumineux",
        "Un poisson-lime avec sa peau rugueuse comme du papier de verre",
        "Un poisson-faucon perché sur une tête de corail, guettant une proie",
        "Un poisson-cardinal flottant dans une grotte sombre",
        "Un labre nettoyant un poisson plus grand à une station de nettoyage",
        "Un magnifique et rare dragon de mer feuillu",
        "Un poisson-lanterne avec son organe bioluminescent brillant",
        "Un poisson-vache avec ses cornes proéminentes",
        "Un poulpe à anneaux bleus, beau mais mortel",
        "Un bénitier géant avec son manteau coloré exposé",
        "Un ver arbre de Noël sur une tête de corail",
        "Une étoile de mer accrochée à un rocher",
        "Un nudibranche coloré rampant sur le récif",
        "Une crevette nettoyeuse au travail sur un poisson plus grand",
        "Un petit hippocampe pygmée sur un éventail de mer",
        "Un mérou corallien avec ses taches rouges et bleues brillantes",
        "Un poisson volant sautant hors de l'eau",
        "Un barracuda avec ses dents acérées visibles",
        "Un requin-baleine nageant paisiblement près de la surface",
        "Un poisson-lune, ou môle môle, près de la surface",
        "Un banc de poissons-anges dans un lagon cristallin"
    ],
    "Paysages de Montagne": [
        "Un majestueux sommet de montagne enneigé au lever du soleil",
        "Une vallée verdoyante nichée entre des montagnes escarpées",
        "Une route de montagne sinueuse en automne avec des arbres colorés",
        "Un lac alpin serein reflétant les sommets environnants",
        "Un randonneur solitaire sur une crête de montagne surplombant un vaste paysage",
        "La silhouette dramatique d'une chaîne de montagnes au coucher du soleil",
        "Une cascade dévalant une falaise rocheuse de montagne",
        "Un chalet rustique en rondins dans une forêt de montagne",
        "Un ciel nocturne étoilé au-dessus d'une chaîne de montagnes sombre",
        "Nuages et brouillard roulant à travers un col de montagne",
        "Une montagne volcanique déchiquetée avec de la fumée s'élevant de son cratère",
        "Le sommet du Cervin dans les Alpes suisses",
        "Une vue panoramique de l'Himalaya",
        "Un champ coloré de fleurs sauvages dans une prairie de montagne",
        "Un glacier se déplaçant lentement dans une vallée de montagne",
        "Une chèvre de montagne perchée sur un bord de falaise précaire",
        "Les aurores boréales au-dessus d'un paysage montagneux enneigé",
        "Un monastère bouddhiste haut dans les montagnes du Tibet",
        "Un train voyageant sur un pont ferroviaire de montagne élevé",
        "Le Grand Canyon avec ses formations rocheuses stratifiées",
        "Un paysage désertique avec des mesas et des buttes en arrière-plan",
        "Une forêt dense de pins sur les pentes d'une montagne",
        "Un parapentiste planant au-dessus d'une chaîne de montagnes",
        "Les formations rocheuses uniques de Zhangjiajie, Chine",
        "Une ferme traditionnelle en terrasses sur une pente de montagne raide",
        "Un pont suspendu traversant une gorge de montagne profonde",
        "Les collines ondulantes des Highlands écossais",
        "Un orage se rassemblant au-dessus d'une montagne sombre et imposante",
        "Un ruisseau de montagne avec de l'eau claire coulant sur des pierres lisses",
        "L'emblématique Mont Fuji au Japon avec des cerisiers en fleurs au premier plan",
        "Une vue des montagnes des Andes depuis Machu Picchu",
        "Une tour de guet solitaire sur une crête de montagne",
        "Un grimpeur d'escalade escaladant une face de montagne abrupte",
        "La chaîne dramatique des Dolomites en Italie au coucher du soleil",
        "Un arc-en-ciel apparaissant au-dessus d'une vallée de montagne après un orage",
        "Les ruines d'un château ancien au sommet d'une montagne",
        "Les couleurs vibrantes des Montagnes Arc-en-ciel du Pérou",
        "Un téléphérique montant une montagne escarpée",
        "Un feu de forêt sur le flanc d'une montagne distante la nuit",
        "Un troupeau de moutons paissant sur une pente de montagne verte",
        "Un vététiste sur un sentier étroit et difficile",
        "La lune se levant au-dessus d'un sommet de montagne silhouetté",
        "Une cascade gelée sur une montagne en hiver",
        "La vue depuis un sommet de montagne, au-dessus des nuages",
        "Un chalet traditionnel dans les Alpes avec des fleurs sur le balcon",
        "L'ombre longue d'une montagne s'étendant à travers une vallée",
        "Une rivière creusant un canyon à travers une chaîne de montagnes",
        "Un double arc-en-ciel au-dessus d'un paysage de montagne vert",
        "Les aurores boréales au-dessus du mont Kirkjufell en Islande",
        "Un sentier sinueux menant à une montagne herbeuse"
    ],
    "Arbres Bonsaï": [
        "Un délicat bonsaï d'érable japonais avec des feuilles rouges en automne",
        "Un bonsaï de genévrier ancien et noueux dans un pot en céramique",
        "Un bonsaï d'azalée en fleurs avec des fleurs roses vibrantes",
        "Un bonsaï de style cascade poussant sur le côté de son pot",
        "Un bonsaï de style forêt avec plusieurs petits arbres créant une forêt miniature",
        "Un bonsaï de style balayé par le vent, semblant façonné par des vents forts",
        "Un gros plan de l'écorce texturée sur un vieux bonsaï de pin",
        "Un maître bonsaï taillant soigneusement un petit arbre avec des outils spécialisés",
        "Un bonsaï de cerisier en pleine floraison",
        "Un bonsaï exposé dans une alcôve tokonoma japonaise traditionnelle",
        "Un bonsaï de ficus avec des racines aériennes exposées créant un style banian",
        "Un paysage miniature (saikei) avec un bonsaï, des roches et de la mousse",
        "Un bonsaï de style lettré avec un tronc haut et mince et un feuillage clairsemé",
        "Un bonsaï couvert d'une légère couche de neige en hiver",
        "Une plante de jade cultivée en bonsaï",
        "Un bonsaï de bougainvillée avec des fleurs colorées ressemblant à du papier",
        "Un bonsaï de style racine sur roche avec ses racines accrochées à une pierre",
        "Une collection de divers bonsaïs dans un cadre de jardin serein",
        "Un gros plan des feuilles minuscules d'un bonsaï de buis",
        "Un bonsaï avec des fruits miniatures, comme un pommier ou un agrume",
        "Un bonsaï de style vertical formel (Chokkan) de pin",
        "Un bonsaï de style vertical informal (Moyogi) avec des courbes douces dans le tronc",
        "Un bonsaï de style incliné (Shakan), penché sur un côté",
        "Un bonsaï de style semi-cascade (Han-kengai)",
        "Un bonsaï de style balai (Hokidachi) de zelkova",
        "Une plantation de groupe (Yose-ue) de bonsaïs",
        "Arroser un bonsaï avec un arrosoir à bec fin",
        "Un bonsaï sur un support en bois pour exposition",
        "Le système racinaire complexe (nebari) d'un bonsaï bien cultivé",
        "Un bonsaï de genévrier avec des caractéristiques de bois mort (jin et shari)",
        "Un bonsaï de grenadier avec un seul petit fruit",
        "Un bonsaï de glycine avec des grappes de fleurs violettes suspendues",
        "Un bonsaï de séquoia dans un pot peu profond",
        "Le processus de rempotage d'un bonsaï",
        "Une exposition minimaliste d'un seul bonsaï dans une pièce vide",
        "Un bonsaï à côté d'une petite tasse de thé",
        "La lumière du soleil filtrant à travers les feuilles d'un bonsaï délicat",
        "Un bonsaï de ginkgo avec ses feuilles uniques en forme d'éventail devenant jaunes",
        "Un bonsaï de style bois flotté, où l'arbre pousse sur un morceau de bois flotté",
        "Un gros plan du sol et de la mousse dans un pot de bonsaï",
        "Un olivier cultivé en bonsaï",
        "Un bonsaï de pyracantha avec des baies rouges brillantes",
        "Un bonsaï de myrte de crêpe avec son écorce distinctive et ses fleurs",
        "Un bonsaï de genévrier shimpaku étant ligaturé pour le façonnage",
        "Une exposition de bonsaï avec de nombreux arbres exposés",
        "Un petit bonsaï mame, assez petit pour tenir dans une main",
        "Un bonsaï sur un rebord de fenêtre, silhouetté contre la lumière",
        "Un bonsaï reflété dans un bassin d'eau calme",
        "Un bonsaï de cèdre avec un feuillage tombant",
        "Un baobab cultivé en bonsaï"
    ],
    "Desserts Gastronomiques": [
        "Une tranche de gâteau au chocolat fondant riche avec un centre en fusion",
        "Un délicat tiramisu multi-couches saupoudré de cacao en poudre",
        "Une tarte aux fruits vibrante avec kiwi, fraises et myrtilles sur crème pâtissière",
        "Un cheesecake classique de New York avec une croûte de biscuits graham et nappage aux cerises",
        "Une assiette de macarons français colorés de différentes saveurs",
        "Une crème brûlée avec un dessus de sucre parfaitement caramélisé",
        "Une boule de gelato artisanal à la pistache dans un cornet de gaufre",
        "Un gâteau Forêt-Noire décadent avec des couches de chocolat, crème et cerises",
        "Un crumble aux pommes chaud avec une boule de glace à la vanille",
        "Un trio de desserts miniatures : tartelette au citron meringuée, mousse au chocolat et panna cotta",
        "Un opéra parfaitement construit avec des couches de biscuit aux amandes, sirop au café et ganache",
        "Un shortcake aux fraises léger et aérien avec crème fouettée fraîche",
        "Une pile de crêpes moelleuses avec sirop d'érable et une noix de beurre",
        "Un cupcake red velvet magnifiquement décoré avec glaçage au fromage à la crème",
        "Une tranche de tarte au citron vert avec garniture de meringue grillée",
        "Un cannoli italien traditionnel fourré de fromage ricotta sucré",
        "Un cookie aux pépites de chocolat chaud et fondant tout juste sorti du four",
        "Un verre de parfait dessert en couches avec fruits, yaourt et granola",
        "Une tarte sophistiquée au chocolat noir et framboise",
        "Un élégant chou à la crème en forme de cygne (choux au craquelin)",
        "Une assiette de churros avec un côté de chocolat chaud épais pour tremper",
        "Une tranche de tarte aux pacanes avec une croûte feuilletée",
        "Un gâteau raindrop japonais, un dessert gélatineux transparent",
        "Une boule de sorbet rafraîchissant au citron dans un verre refroidi",
        "Une gaufre belge garnie de sucre glace, fruits et sauce au chocolat",
        "Un délicat mille-feuille (Napoléon) avec des couches de pâte feuilletée et crème",
        "Un roulé à la cannelle fraîchement cuit avec glaçage coulant dessus",
        "Un bol de flan espagnol avec sauce caramel riche",
        "Un pudding au caramel anglais traditionnel avec sauce au caramel",
        "Un gâteau fondant au thé matcha vert",
        "Un dessert déconstruit présenté de manière artistique dans une assiette",
        "Une omelette norvégienne, glace enrobée de meringue et flambée",
        "Une tranche de tarte à la citrouille avec une cuillère de crème fouettée",
        "Un verre d'affogato : une boule de glace vanille noyée dans un espresso chaud",
        "Un baklava turc avec des couches de phyllo, noix et miel",
        "Un cheesecake japonais coloré et tremblotant",
        "Un dessert de riz gluant à la mangue de Thaïlande",
        "Un pastel de nata portugais (tarte aux œufs) avec dessus cloqué",
        "Une tranche de gâteau aux carottes avec glaçage au fromage à la crème et noix",
        "Une mousse au chocolat et avocat dans un verre",
        "Un cronut, l'hybride croissant-beignet, avec une garniture créative",
        "Une assiette de syrniki russes (crêpes au fromage) avec crème aigre et confiture",
        "Une panna cotta italienne avec coulis de baies",
        "Un bol d'Eton mess avec fraises, meringue et crème",
        "Une banane congelée trempée dans le chocolat avec vermicelles",
        "Une madeleine française classique",
        "Un pudding au pain chaud avec sauce au whisky",
        "Une tranche de gâteau des anges avec baies fraîches",
        "Une tarte au chocolat et avocat végane et sans gluten",
        "Un mochi glacé coupé en deux pour montrer la garniture"
    ],
    "Instruments de Musique": [
        "Un piano à queue sur une scène sous un projecteur",
        "Une guitare acoustique appuyée contre un tabouret dans une pièce confortable",
        "Un gros plan des cordes et des ouïes d'un violon",
        "Un saxophone en laiton brillant reflétant les lumières d'un club de jazz",
        "Une batterie complète prête pour un concert de rock",
        "Un magnifique violoncelle en bois appuyé contre une chaise",
        "Une rangée de guitares électriques colorées accrochées à un mur",
        "Un musicien jouant une flûte argentée",
        "Les touches et boutons complexes d'une clarinette",
        "Un majestueux orgue à tuyaux dans une grande cathédrale",
        "Une cornemuse écossaise traditionnelle en cours de jeu",
        "Une harpe avec ses courbes élégantes et nombreuses cordes",
        "Une trompette vintage sur un tissu de velours",
        "Un ensemble de bongos sur une plage de sable",
        "Une contrebasse dans le coin d'un studio de musique",
        "Les touches blanches et noires d'un clavier synthétiseur",
        "Une seule cymbale luisante sur un support",
        "Un marimba en bois avec ses barres graduées",
        "Un accordéon joué par un musicien de rue",
        "Un banjo avec son corps rond distinctif",
        "Un cor d'harmonie avec sa tuyauterie enroulée",
        "L'embouchure et le pavillon d'un trombone",
        "Une magnifique mandoline avec incrustation de nacre",
        "Une paire de maracas, peintes de couleurs vives",
        "Un koto japonais traditionnel, un long instrument à cordes",
        "Un sitar indien avec son long manche et nombreuses cordes",
        "Un triangle, tenu par une ficelle, sur le point d'être frappé",
        "Un didgeridoo, un long instrument à vent en bois d'Australie",
        "Le clavier d'un clavecin",
        "Un ensemble de steel drums des Caraïbes",
        "Une basse électrique sur un support",
        "Un ukulélé avec un motif floral",
        "Les anches d'un harmonica, gros plan",
        "Un ensemble de timbales dans un orchestre",
        "Un magnifique hautbois, fait de bois sombre",
        "Une grande concertina, un type d'accordéon",
        "Un piano à pouce (kalimba) en cours de jeu",
        "Un râtelier de divers instruments de percussion : tambourins, cloches à vache, etc.",
        "Un luth, un instrument à cordes de la Renaissance",
        "Les pédales d'un piano à queue, gros plan",
        "Un thérémine, un instrument électronique joué sans contact physique",
        "Une balalaïka, un instrument à cordes triangulaire russe",
        "Un hang drum, un tambour en acier convexe joué avec les mains",
        "Un ensemble de carillons éoliens soufflant doucement dans la brise",
        "Un microphone vintage dans un studio d'enregistrement, avec un instrument en arrière-plan",
        "Un pupitre avec partition, devant un instrument",
        "L'intérieur d'un piano, montrant les marteaux et les cordes",
        "Un harmonica de verre, avec ses bols de verre rotatifs",
        "Une console de mixage sonore dans un studio d'enregistrement, avec instruments visibles",
        "Un étui à violon, ouvert pour montrer l'instrument niché à l'intérieur"
    ],
    "Horizons Urbains de Nuit": [
        "L'horizon scintillant de New York la nuit, vu de l'autre côté de la rivière",
        "L'horizon futuriste de Shanghai avec la Tour de la Perle d'Orient illuminée",
        "L'horizon emblématique de Londres au crépuscule, avec Tower Bridge illuminé",
        "Les lumières étendues de Tokyo la nuit depuis un point de vue élevé",
        "L'horizon unique de Dubaï la nuit, mettant en vedette le Burj Khalifa",
        "L'horizon romantique de Paris la nuit, avec la Tour Eiffel scintillante",
        "L'horizon vibrant de Hong Kong la nuit, avec son célèbre spectacle de lumières",
        "L'horizon de Chicago la nuit, reflété dans le lac Michigan",
        "L'horizon de Sydney la nuit, avec l'Opéra et le Harbour Bridge",
        "L'horizon coloré et dense de São Paulo, Brésil la nuit",
        "L'horizon de Toronto la nuit avec la Tour CN proéminente",
        "L'horizon de Seattle la nuit, avec la Space Needle illuminée",
        "Un cliché en pose longue d'un horizon urbain la nuit, avec des traînées de lumière du trafic",
        "L'horizon moderne de Singapour la nuit, avec Marina Bay Sands",
        "L'horizon historique de Moscou la nuit, avec le Kremlin et la cathédrale Saint-Basile",
        "Une vue panoramique de l'horizon de Los Angeles la nuit, s'étendant jusqu'à l'horizon",
        "L'horizon de Kuala Lumpur la nuit, avec les Tours Petronas",
        "Un orage au-dessus d'un horizon urbain la nuit",
        "Le reflet d'un horizon urbain dans une rivière calme la nuit",
        "Un feu d'artifice au-dessus d'un horizon urbain la nuit",
        "L'horizon de Las Vegas la nuit, un étalage éblouissant de lumières",
        "La vue d'un horizon urbain la nuit depuis la fenêtre d'un avion",
        "L'horizon brumeux et néon d'une ville cyberpunk la nuit",
        "La lune se levant au-dessus d'un horizon urbain",
        "L'horizon d'une ville côtière la nuit, avec des lumières de bateaux dans le port",
        "Une fête sur un toit avec un horizon urbain la nuit en arrière-plan",
        "L'horizon de Taipei la nuit, avec Taipei 101",
        "Une photo en time-lapse des étoiles se déplaçant au-dessus d'un horizon urbain",
        "Le quartier des affaires d'une grande ville la nuit, avec des lumières de bureaux allumées",
        "L'horizon de Doha, Qatar, avec son architecture moderne illuminée la nuit",
        "Un pont menant à une ville avec un magnifique horizon la nuit",
        "L'horizon d'une ville pendant l'heure bleue juste après le coucher du soleil",
        "Une nuit brumeuse dans une ville, avec les lumières de l'horizon diffusées par le brouillard",
        "L'horizon de Rio de Janeiro la nuit, avec la statue du Christ Rédempteur",
        "Un cliché rapproché et abstrait des lumières et fenêtres d'un horizon urbain la nuit",
        "L'horizon d'une ville dans une tempête de neige la nuit",
        "Une personne sur un balcon regardant un vaste horizon urbain la nuit",
        "L'horizon de Francfort, Allemagne, avec son groupe de gratte-ciel",
        "Un horizon urbain la nuit avec une pleine lune",
        "Le contraste entre une partie ancienne et historique d'une ville et l'horizon moderne la nuit",
        "L'horizon d'Atlanta la nuit, avec son architecture distinctive",
        "L'horizon de Bangkok la nuit, avec son mélange de temples et gratte-ciel",
        "Une vue d'un horizon urbain à travers une fenêtre striée de pluie la nuit",
        "L'horizon d'une ville sur une péninsule, entourée d'eau et de lumières",
        "Une zone suburbaine tranquille avec la lueur lointaine d'un horizon urbain à l'horizon",
        "L'horizon de Séoul la nuit, avec la Tour N de Séoul sur la montagne",
        "Un horizon urbain la nuit pendant un festival, avec lanternes ou éclairage spécial",
        "Le reflet d'un horizon urbain éclairé au néon sur une rue mouillée",
        "Une image composite d'un horizon urbain avec une galaxie ou nébuleuse dans le ciel",
        "L'horizon d'une ville avec un monument célèbre, comme la Gateway Arch à Saint-Louis, la nuit"
    ],
    "Oiseaux Exotiques": [
        "Un ara écarlate avec ses plumes brillantes rouges, jaunes et bleues",
        "Un paon déployant ses magnifiques plumes de queue iridescentes",
        "Un toucan avec son grand bec coloré, perché sur une branche",
        "Un flamant rose debout sur une patte dans des eaux peu profondes",
        "Un colibri en vol stationnaire, se nourrissant de nectar d'une fleur",
        "Un pygargue à tête blanche majestueux en vol, avec sa tête et sa queue blanches",
        "Un harfang des neiges avec ses yeux jaunes brillants, sur un fond hivernal",
        "Un bruant peint coloré, un petit oiseau avec un mélange de bleu, vert, jaune et rouge",
        "Un martin-pêcheur plongeant dans l'eau pour attraper un poisson",
        "Un macareux moine avec son bec coloré, debout sur une falaise",
        "Un goura de Victoria, un grand pigeon gris-bleu avec une crête en dentelle",
        "Le quetzal exotique avec ses longues et belles plumes de queue",
        "Un paradisier exécutant sa danse de parade nuptiale élaborée",
        "Un rollier à longs brins, montrant ses nombreuses couleurs en vol",
        "Un ara hyacinthe, la plus grande espèce d'ara, en bleu profond",
        "Un calao à casque rond avec son grand casque sur le dessus de son bec",
        "Un serpentaire bacha, un grand oiseau de proie terrestre",
        "Un bec-en-sabot du Nil, avec son énorme bec en forme de sabot",
        "Un diamant de Gould coloré, avec son plumage vibrant",
        "Un casoar, un grand oiseau incapable de voler avec un casque sur sa tête",
        "Un coq-de-roche péruvien, un oiseau orange vif d'Amérique du Sud",
        "Un kookaburra d'Australie, connu pour son cri de rire",
        "Un faisan doré, avec sa crête dorée brillante et son corps rouge",
        "Un canard mandarin, avec son plumage orné et coloré",
        "Un faucon pèlerin, l'animal le plus rapide du monde, en piqué",
        "Un hoazin huppé, un oiseau étrange avec une crête et une apparence reptilienne",
        "Un eurylaime à longue queue, un petit oiseau vert brillant d'Asie",
        "Un étourneau superbe, avec ses plumes iridescentes brillantes",
        "Un calao rhinocéros, avec son grand casque courbé",
        "Un trogon resplendissant, un groupe d'oiseaux colorés des régions tropicales",
        "Un fou à pieds bleus, exécutant sa danse de parade nuptiale",
        "Une frégate superbe, avec son grand sac gulaire rouge gonflable",
        "Un ibijau gris, maître du camouflage, perché sur une souche d'arbre",
        "Un colibri porte-épée, avec un bec plus long que son corps",
        "Le kakapo, un grand perroquet nocturne incapable de voler de Nouvelle-Zélande",
        "Un gypaète barbu, connu pour laisser tomber des os depuis une hauteur",
        "Une perruche soleil, un petit perroquet aux couleurs vives",
        "Un canard carolin, avec ses motifs et couleurs complexes",
        "Un motmot, un oiseau avec une longue queue aux extrémités en forme de raquette",
        "Un calao à casque plat, avec un casque solide utilisé pour combattre",
        "Un touraco, un groupe d'oiseaux africains colorés",
        "Un paradisier de Wilson, avec ses plumes de queue enroulées et sa tête bleue",
        "Un jardinier satiné, avec sa tonnelle décorée d'objets bleus",
        "Un jacana, un oiseau qui peut marcher sur la végétation flottante",
        "Une chevêche des terriers, debout à l'entrée de son terrier",
        "Un podarge de Ceylan, un autre maître du camouflage",
        "La huppe fasciée, avec sa couronne distinctive de plumes",
        "Un aigle des Philippines, un grand et puissant oiseau de proie",
        "Un mérion splendide, un petit oiseau au plumage bleu brillant",
        "Un groupe de manchots d'Adélie en Antarctique"
    ],
    "Motifs Géométriques Abstraits": [
        "Une tessellation de formes hexagonales imbriquées en motif en nid d'abeille",
        "Une spirale de carrés de suite de Fibonacci, une spirale dorée",
        "Un motif fractal complexe, comme un ensemble de Mandelbrot, avec des détails complexes",
        "Un motif répétitif de triangles colorés, en design sans couture",
        "Une grille de cercles qui se chevauchent, créant un motif géométrique de fleur de vie",
        "Un motif d'art optique noir et blanc avec des lignes ondulées créant une illusion de mouvement",
        "Un motif de cube 3D, une projection isométrique créant une illusion optique",
        "Un motif radial de lignes angulaires pointues émanant d'un point central",
        "Un design vectoriel de formes géométriques abstraites minimalistes en couleurs pastel",
        "Un motif de cercles concentriques dans un arc-en-ciel de couleurs",
        "Un motif chaotique et abstrait de fragments et lignes géométriques aléatoires",
        "Un motif sans couture de carreaux zelliges marocains avec des formes d'étoile et de croix",
        "Un motif futuriste et numérique de grilles et lignes néon brillantes",
        "Un motif simple et élégant de lignes parallèles d'épaisseur et couleur variables",
        "Un design de vitrail avec des lignes de plomb géométriques et du verre coloré",
        "Un motif Art déco avec des formes géométriques audacieuses et symétriques",
        "Un motif kaléidoscopique, symétrique et plein de formes répétitives",
        "Un motif de carrés et rectangles imbriqués, rappelant le travail de Piet Mondrian",
        "Un arrière-plan low poly avec un réseau de triangles connectés",
        "Un motif géométrique inspiré de l'art islamique, avec des motifs d'étoiles complexes",
        "Un motif de pois, disposés dans une grille parfaite",
        "Un motif chevron avec des lignes pointues en zigzag",
        "Un motif de plaid ou tartan, avec des bandes horizontales et verticales qui se croisent",
        "Un motif d'argyle, avec des diamants et des lignes qui se croisent",
        "Un motif pied-de-poule, un motif textile bicolore de carreaux brisés",
        "Un pavage de Penrose, un pavage apériodique avec deux formes",
        "Un motif de formes filaires 3D, comme des cubes, sphères et pyramides",
        "Un motif de style Memphis design avec des formes géométriques ludiques et colorées",
        "Un motif en rayon de soleil, avec des rayons s'étendant d'un point central",
        "Un motif d'ondes sonores, représentées comme des lignes géométriques",
        "Un code QR, un motif géométrique fonctionnel",
        "Un motif de circuit imprimé, avec ses lignes et composants complexes",
        "Un motif de grecque antique (méandre)",
        "Un motif de nœud celtique, avec ses boucles entrelacées sans fin",
        "Un design inspiré du Bauhaus avec des formes géométriques simples : cercles, carrés, triangles",
        "Un motif de sphères disposées dans une structure de réseau cristallin",
        "Une représentation abstraite d'une carte de ville, avec des blocs et lignes géométriques",
        "Un motif de carrés qui se chevauchent avec différentes opacités",
        "Un motif géométrique fait de papier découpé, avec des ombres créant de la profondeur",
        "Un motif de formes de diamant rayonnantes",
        "Un arrière-plan minimaliste avec une seule grande forme géométrique",
        "Un motif de formes impossibles de style Escher",
        "Un motif de demi-teintes, avec des points de taille variable créant une image",
        "Un motif de rubans ou bandes colorés qui se croisent",
        "Un design basé sur le nombre d'or, avec des proportions harmonieuses",
        "Un diagramme de Voronoï, un motif de cellules autour de points",
        "Un motif géométrique qui semble reculer vers un point de fuite",
        "Un motif de triangles formant un fractal de triangle de Sierpinski",
        "Un simple motif rayé, avec des rayures verticales ou horizontales",
        "Un motif en damier, avec des carrés noirs et blancs alternés"
    ]
}

def main():
    """
    Fonction principale pour générer et organiser l'ensemble de données.
    """
    # --- Étape 1: Initialiser le modèle ---
    print("Chargement du modèle Stable Diffusion...")
    device = "cuda:1" if torch.cuda.is_available() else "cpu"
    pipe = StableDiffusionPipeline.from_pretrained(MODEL_ID, torch_dtype=torch.float16)
    pipe = pipe.to(device)
    print(f"Modèle chargé avec succès sur {device}.")

    # --- Étape 2: Créer les répertoires et générer les données ---
    print(f"Création du répertoire principal : {OUTPUT_DIR}")
    os.makedirs(OUTPUT_DIR, exist_ok=True)

    # Itérer à travers le curriculum dans l'ordre spécifié
    for i, concept_name in enumerate(CURRICULUM_ORDER):
        # Formater le nom du concept pour le répertoire
        concept_dir_name = f"{i+1:02d}_{concept_name.lower().replace(' ', '_')}"
        concept_path = os.path.join(OUTPUT_DIR, concept_dir_name)
        os.makedirs(concept_path, exist_ok=True)
        
        print(f"\n--- Traitement du concept {i+1}/{len(CURRICULUM_ORDER)}: {concept_name} ---")
        print(f"Sauvegarde dans : {concept_path}")

        metadata_path = os.path.join(concept_path, "metadata.jsonl")
        
        with open(metadata_path, 'w', encoding='utf-8') as metadata_file:
            prompts_for_concept = PROMPTS.get(concept_name, [])
            if not prompts_for_concept:
                print(f"  Avertissement : Aucun prompt trouvé pour le concept '{concept_name}'. Passage.")
                continue
            
            for j, prompt in enumerate(prompts_for_concept):
                print(f"  Génération de l'image {j+1}/{len(prompts_for_concept)} pour le prompt : '{prompt[:50]}...'")

                try:
                    # Générer l'image
                    image = pipe(
                        prompt, 
                        negative_prompt=NEGATIVE_PROMPT, 
                        num_inference_steps=50, 
                        guidance_scale=7.5
                    ).images[0]

                    # Définir le nom du fichier image et le sauvegarder
                    image_filename = f"image_{j:03d}.png"
                    image_path = os.path.join(concept_path, image_filename)
                    image.save(image_path)

                    # Créer l'entrée de métadonnées et l'écrire dans le fichier
                    metadata_entry = {
                        "file_name": image_filename,
                        "prompt": prompt
                    }
                    metadata_file.write(json.dumps(metadata_entry, ensure_ascii=False) + "\n")

                except Exception as e:
                    print(f"  ERREUR lors de la génération de l'image pour le prompt '{prompt}' : {e}")


    print("\n✅ Génération et organisation de l'ensemble de données sûr terminées !")
    print(f"Votre ensemble de données de fine-tuning est prêt à : {OUTPUT_DIR}")

if __name__ == "__main__":
    main()